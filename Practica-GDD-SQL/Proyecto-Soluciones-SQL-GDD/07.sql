/*Generar una consulta que muestre para cada artículo 
-código
-detalle
-mayor precio
-menor precio
-% de la diferencia de precios
(respecto del menor Ej.: menor precio = 10, mayor precio =12 => mostrar 20 %).

Mostrar solo aquellos artículos que posean stock.*/

SELeCT 
prod_codigo,
prod_detalle, 
MIN(item_precio), 
MAX(item_precio), 
( (MAX(item_precio)- MIN(item_precio)) / MIN(item_precio) *100) 
FROM Producto
JOIN Item_Factura
ON prod_codigo = item_producto

WHERE prod_codigo in (	SELECT stoc_producto from stock
						group by stoc_producto
						HAVING sum(stoc_cantidad) > 0)
group by prod_codigo,prod_detalle
ORDER BY prod_codigo

SELECT stoc_producto
--, sum(stoc_cantidad) 
from stock
group by stoc_producto
HAVING sum(stoc_cantidad) > 0

--1360
order by sum(stoc_cantidad)

00010421
00010706
00010712
00010168
00010172
00010180
00000817
00014126
00010168
00010112
00010113
00006496
00002814
00009808
00010658
00010101
00010167
00010157
00002805
00002812
00002508
00010109
00006255
00010130
00010134
00010132
00010114
00010118
00010142
00010180
00010168
00010180
00010280
00010283
00010286
00010290
00010291
00010291
00010292
00010299
00010308
00010428
00010429
00010381
00010382
00010382
00010384
00010387
00010388
00010389
00010392
00010321
00010336
00010341
00010341
00010343
00010351
00010360
00010362
00010362
00010362
00010364
00010364
00010368
00006255
00006256
00006256
00006251
00006252
00006252
00006146
00006250
00006250
00006402
00006402
00006402
00006402
00006404
00006404
00006411
00006411
00006411
00006411
00006499
00007130
00010105
00010104
00009913
00009914
00009925
00009925
00009940
00009831
00009905
00009907
00008224
00009605
00009606
00009612
00009616
00009615
00009625
00002533
00002812
00002818
00002805
00002604
00002605
00002605
00002556
00003817
00003818
00003909
00004608
00005703
00001718
00001718
00001719
00001721
00001719
00001774
00002160
00000817
00000810
00000817
00000818
00000824
00000302
00000303
00000304
00000304
00000304
00000304
00000806
00000173
00000176
00000890
00000890
00000892
00001102
00001102
00001118
00001433
00001540
00001707
00001707
00001707
00001707
00001710
00010654
00010664
00010644
00014002
00014016
00014019
00014021
00014032
00014126
00014040
00014065
00010502
00010558
00010559
00010566
00010580
00010616
00010618
00010638
00010635